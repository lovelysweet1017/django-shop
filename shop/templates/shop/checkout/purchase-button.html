{% load i18n static sass_tags sekizai_tags %}{% spaceless %}

{% addtoblock "css" %}<link href="{% sass_src 'shop/css/djng-forms.scss' %}" rel="stylesheet" type="text/css" />{% endaddtoblock %}
{% if stylesheet_url %}{% addtoblock "css" %}<link href="{{ stylesheet_url }}" rel="stylesheet" type="text/css" />{% endaddtoblock %}{% endif %}

{% addtoblock "js" %}<script src="{% static 'djng/js/django-angular.min.js' %}" type="text/javascript"></script>{% endaddtoblock %}
{% add_data "ng-requires" "djng.forms" %}

{% addtoblock "js" %}<script src="{% static 'shop/js/purchase-button.js' %}" type="text/javascript"></script>{% endaddtoblock %}
{% add_data "ng-requires" "django.shop.purchase-button" %}

<div class="alert alert-danger" ng-show="purchasingErrorMessage" role="alert" ng-cloak>
	<a class="close" ng-click="purchasingErrorMessage=null" uib-tooltip="{% trans 'Dismiss' %}">Ã—</a>{% verbatim %}{{ purchasingErrorMessage }}{% endverbatim %}
</div>

{% with instance_css_classes=instance.css_classes instance_inline_styles=instance.inline_styles disable_invalid=instance.glossary.disable_invalid|default:True %}
<button ng-click="do(spinner()).then(prepare()).then(update()).then(purchaseNow('{% url 'shop:checkout-purchase' %}')).finally(restore())"{% if disable_invalid %} ng-disabled="isDisabled()"{% endif %}{% if instance_css_classes %} class="{{ instance_css_classes }}"{% endif %}{% if instance_inline_styles %} style="{{ instance_inline_styles }}"{% endif %}>
	{{ icon_left }}{{ instance.content }}{{ icon_right }}
</button>
{% endwith %}

{% endspaceless %}
