{% load i18n static cascade_tags sass_tags sekizai_tags %}
{% load render_plugin from cascade_tags %}

{% addtoblock "css" %}<link href="{% sass_src 'shop/css/tables.scss' %}" rel="stylesheet" type="text/css" />{% endaddtoblock %}

{% addtoblock "js" %}<script src="{% static 'shop/js/utils.js' %}" type="text/javascript"></script>{% endaddtoblock %}
{% add_data "ng-requires" "django.shop.utils" %}

{% block shop-order-title %}
<h3>{% trans "Order" %} {{ data.number }}
	<small class="ml-1">{% trans "from" context "order-detail" %} <span shop-timestamp="{{ data.created_at }}"></span></small>
	<small class="badge badge-primary pull-right">{{ data.status }}</small>
</h3>
{% endblock %}

{% block shop-order-delivery %}
<div class="row my-3">
	<div class="col">
		<div class="card">
			<h5 class="card-header">{% trans "Shipping Address" %}</h5>
			<div class="card-body">
				<pre class="card-text">{{ data.shipping_address_text }}</pre>
			</div>
			<div class="card-footer text-primary">{% trans "Shipping Method" %}: {{ data.active_shipping_method.label }}</div>
		</div>
	</div>
	<div class="col">
		<div class="card">
			<h5 class="card-header">{% trans "Billing Address" %}</h5>
			<div class="card-body">
				<pre class="card-text">{{ data.billing_address_text }}</pre>
			</div>
			<div class="card-footer text-primary">{% trans "Payment Method" %}: {{ data.active_payment_method.label }}</div>
		</div>
	</div>
</div>
{% endblock %}

{% block shop-order-head %}
<h4>{% trans "Ordered Items" %}</h4>
<div class="row lead text-muted py-1">
	<div class="col-2 text-center">{% trans "Quantity" %}</div>
	<div class="col-6 text-center">{% trans "Product" %}</div>
	<div class="col-2 text-right">{% trans "Unit Price" %}</div>
	<div class="col-2 text-right">{% trans "Total" %}</div>
</div>
{% endblock shop-order-head %}

{% block shop-order-body %}{% for item in data.items %}
<div class="row border-top py-3 shop-list-item">
	<div class="col-2 text-center">{{ item.quantity }}</div>
	<div class="col-6 text-left">{{ item.summary.media|safe }}</div>
	<div class="col-4">
		<div class="row">
			<div class="col text-right text-nowrap">
				{{ item.unit_price }}
			</div>
			<div class="col text-right text-nowrap">
				{{ item.line_total }}
			</div>
		</div>
	{% for _, extra_row in item.extra.rows %}
		<div class="row">
			<div class="col text-right text-nowrap">
				{{ extra_row.label }}
			</div>
			<div class="col text-right text-nowrap">
				{{ extra_row.amount }}
			</div>
		</div>
	{% endfor %}
	</div>
</div>
{% endfor %}{% endblock shop-order-body %}

{% block shop-order-foot %}
<div class="row mb-3">
	<div class="col-8">
	{% if instance.left_extension %}{% render_plugin instance.left_extension %}{% endif %}
	</div>
	<div class="col-4 border-top">
		<div class="row py-2">
			<div class="col text-right text-nowrap font-weight-bold">
				{% trans "Subtotal" %}
			</div>
			<div class="col text-right text-nowrap font-weight-bold">
				{{ data.subtotal }}
			</div>
		</div>
	{% for key, extra_row in data.extra.rows %}
		<div class="row py-2">
			<div class="col text-right text-nowrap">{{ extra_row.label }}</div>
			<div class="col text-right text-nowrap">{{ extra_row.amount }}</div>
		</div>
	{% endfor %}
		<div class="row py-2 shop-double-border">
			<div class="col text-right text-nowrap lead font-weight-bold">{% trans "Total" %}</div>
			<div class="col text-right text-nowrap lead font-weight-bold">{{ data.total }}</div>
		</div>
	{% if instance.right_extension %}{% render_plugin instance.right_extension %}{% endif %}
	</div>
</div>
{% endblock shop-order-foot %}
